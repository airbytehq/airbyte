name: David Dummy Workflow (for testing purposes)
# This is a dummy workflow to trigger another workflow for testing purposes.
on:
  push:
    branches:
      - dbgold17/build-and-publish-python-connectors-on-ci
jobs:
  generate-dev-tag:
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Generate dev tag
        id: generate-dev-tag
        run: |
          hash=$(git rev-parse --short=10 HEAD)
          echo "tag-override=dev.$hash" >> $GITHUB_OUTPUT

    outputs:
      tag-override: ${{ steps.generate-dev-tag.outputs.tag-override }}

  build-and-push-connector-image:
    needs: generate-dev-tag
    uses: ./.github/workflows/connector-image-build-push.yml
    strategy:
      matrix:
        connector-name:
          [
            "source-pokeapi",
            "source-spotify",
            "source-twitch",
            "source-twitter",
            "source-xero",
            "source-zenpy",
            "destination-bigquery",
            "destination-postgres",
            "destination-snowflake",
          ]
      max-parallel: 5 # Limit number of parallel jobs
      fail-fast: false # Don't stop on first failure
    with:
      connector-name: ${{ matrix.connector-name }}
      tag-override: ${{ needs.generate-dev-tag.outputs.tag-override }}
      dry-run: true
    secrets: inherit
