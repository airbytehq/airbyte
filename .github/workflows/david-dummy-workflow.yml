name: David Dummy Workflow (for testing purposes)
# This is a dummy workflow to trigger another workflow for testing purposes.
on:
  push:
    branches:
      - dbgold17/build-and-publish-python-connectors-on-ci
jobs:
  build-and-push-connector-image:
    runs-on: ubuntu-24.04
    strategy:
      matrix:
        connector-name:
          - source-pokeapi
          - source-faker
          - source-facebook-marketing
          - source-s3
      max-parallel: 5 # Limit number of parallel jobs
      fail-fast: false # Don't stop on first failure
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Generate dev tag
        id: generate-dev-tag
        run: |
          hash=$(git rev-parse --short=10 HEAD)
          echo "tag-override=dev.$hash" >> $GITHUB_OUTPUT

      - name: Build and Push Connector Image
        uses: ./.github/actions/connector-image-build-push
        with:
          connector-name: ${{ matrix.connector-name }}
          tag-override: ${{ steps.generate-dev-tag.outputs.tag-override }}
          docker-hub-username: ${{ secrets.DOCKER_HUB_USERNAME }}
          docker-hub-password: ${{ secrets.DOCKER_HUB_PASSWORD }}
          dry-run: "true"
