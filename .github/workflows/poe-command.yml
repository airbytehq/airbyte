name: On-Demand Poe Task

on:
  workflow_dispatch:
    inputs:
      comment-id:
        description: Comment ID. Optional.
        required: false
      pr:
        description: PR Number.
        type: number
        required: false
      command:
        description: |
          Poe command to run (without the 'poe' prefix). Optional.
          If not provided, will be detected from the comment text.
        type: string
        required: false

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run-poe-command:
    runs-on: ubuntu-latest
    steps:
      - name: Run Poe Slash Command Processor
        uses: aaronsteers/poe-command-processor@v1.2.3
        with:
          pr: ${{ github.event.inputs.pr }}
          comment-id: ${{ github.event.inputs.comment-id }}
          github-token: ${{ secrets.GH_PAT_MAINTENANCE_OCTAVIA }}
          command: ${{ inputs.command || '' }}
