# See https://github.com/marketplace/actions/project-beta-automations for guidance

name: Platform Project Automation
on:
  issues:
    types: [labeled]

env:
  gh_project_token: ${{ secrets.PARKER_PAT_FOR_PLATFORM_PROJECT_AUTOMATION }}
  organization: airbytehq
  project_id: 6 # https://github.com/orgs/airbytehq/projects/6/views/8
  # map fields with customized labels
  todo: Todo
  done: Done
  in_progress: In Progress

jobs:
  add-area-platform-issues-to-platform-project:
    runs-on: ubuntu-latest
    name: Add area/platform issue to Platform Project
    steps:
      - uses: leonsteinhaeuser/project-beta-automations@v1.1.0
        if: contains(github.event.issue.labels.*.name, 'area/platform')
        with:
          gh_token: ${{ env.gh_project_token }}
          organization: ${{ env.organization }}
          project_id: ${{ env.project_id }}
          resource_node_id: ${{ github.event.issue.node_id }}
          status_value: ${{ env.todo }} # Target status
