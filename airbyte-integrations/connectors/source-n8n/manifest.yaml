version: "4.3.2"
definitions:
  selector:
    extractor:
      field_path:
      - "data"
  requester:
    url_base: "{{ config['host'] }}/api/v1"
    http_method: "GET"
    authenticator:
      type: ApiKeyAuthenticator
      header: X-N8N-API-KEY
      api_token: "{{ config['api_key'] }}"
    request_parameters:
      limit: "250"
  retriever:
    record_selector:
      extractor:
        field_path:
        - "data"
    paginator:
      type: DefaultPaginator
      page_size_option:
        inject_into: "request_parameter"
        field_name: ""
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.nextCursor }}"
        page_size: 250
      page_token_option:
        type: RequestOption
        field_name: "cursor"
        inject_into: "request_parameter"
    requester:
      url_base: "{{ config['host'] }}/api/v1"
      http_method: "GET"
      authenticator:
        type: ApiKeyAuthenticator
        header: X-N8N-API-KEY
        api_token: "{{ config['api_key'] }}"
      request_parameters:
        limit: "250"
  base_stream:
    retriever:
      record_selector:
        extractor:
          field_path:
          - "data"
      paginator:
        type: DefaultPaginator
        page_size_option:
          inject_into: "request_parameter"
          field_name: ""
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.nextCursor }}"
          page_size: 250
        page_token_option:
          type: RequestOption
          field_name: "cursor"
          inject_into: "request_parameter"
      requester:
        url_base: "{{ config['host'] }}/api/v1"
        http_method: "GET"
        authenticator:
          type: ApiKeyAuthenticator
          header: X-N8N-API-KEY
          api_token: "{{ config['api_key'] }}"
        request_parameters:
          limit: "250"
  executions_stream:
    retriever:
      record_selector:
        extractor:
          field_path:
          - "data"
      paginator:
        type: DefaultPaginator
        page_size_option:
          inject_into: "request_parameter"
          field_name: ""
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.nextCursor }}"
          page_size: 250
        page_token_option:
          type: RequestOption
          field_name: "cursor"
          inject_into: "request_parameter"
      requester:
        url_base: "{{ config['host'] }}/api/v1"
        http_method: "GET"
        authenticator:
          type: ApiKeyAuthenticator
          header: X-N8N-API-KEY
          api_token: "{{ config['api_key'] }}"
        request_parameters:
          limit: "250"
streams:
- retriever:
    record_selector:
      extractor:
        field_path:
        - "data"
        type: DpathExtractor
      type: RecordSelector
    paginator:
      type: DefaultPaginator
      page_size_option:
        inject_into: "request_parameter"
        field_name: ""
        type: RequestOption
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.nextCursor }}"
        page_size: 250
      page_token_option:
        type: RequestOption
        field_name: "cursor"
        inject_into: "request_parameter"
    requester:
      url_base: "{{ config['host'] }}/api/v1"
      http_method: "GET"
      authenticator:
        type: ApiKeyAuthenticator
        header: X-N8N-API-KEY
        api_token: "{{ config['api_key'] }}"
      request_parameters:
        limit: "250"
      type: HttpRequester
      path: "/executions"
    type: SimpleRetriever
  type: DeclarativeStream
  name: "executions"
  primary_key: "id"
check:
  stream_names:
  - "executions"
  type: CheckStream
type: DeclarativeSource
spec:
  type: Spec
  documentation_url: https://docs.airbyte.com/integrations/sources/n8n
  connection_specification:
    $schema: http://json-schema.org/draft-07/schema#
    title: N8n Spec
    type: object
    required:
    - host
    - api_key
    additionalProperties: true
    properties:
      host:
        type: string
        description: Hostname of the n8n instance
      api_key:
        type: string
        description: Your API KEY. See <a href="https://docs.n8n.io/api/authentication">here</a>
