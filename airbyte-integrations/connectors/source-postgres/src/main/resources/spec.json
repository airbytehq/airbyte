{
  "documentationUrl": "https://docs.airbyte.io/integrations/sources/postgres",
  "connectionSpecification": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Postgres Source Spec",
    "type": "object",
    "required": [
      "host",
      "port",
      "database",
      "username"
    ],
    "additionalProperties": false,
    "properties": {
      "host": {
        "title": "Host",
        "description": "Hostname of the database.",
        "type": "string",
        "order": 0
      },
      "port": {
        "title": "Port",
        "description": "Port of the database.",
        "type": "integer",
        "minimum": 0,
        "maximum": 65536,
        "default": 5432,
        "examples": [
          "5432"
        ],
        "order": 1
      },
      "tunnel_method": {
        "type": "object",
        "title": "SSH Tunnel Method",
        "description": "Whether to initiate an SSH tunnel before connecting to the database, and if so, which kind of authentication to use.",
        "order": 5,
        "oneOf": [
          {
            "title": "No Tunnel",
            "required": [
              "tunnel_method"
            ],
            "properties": {
              "tunnel_method": {
                "description": "No ssh tunnel needed to connect to database",
                "type": "string",
                "enum": [
                  "NO_TUNNEL"
                ],
                "default": "NO_TUNNEL",
                "order": 0
              }
            }
          },
          {
            "title": "SSH Key Authentication",
            "required": [
              "tunnel_method",
              "tunnel_host",
              "tunnel_ssh_port",
              "tunnel_username",
              "tunnel_localport",
              "tunnel_usersshkey"
            ],
            "properties": {
              "tunnel_method": {
                "description": "Connect through a jump server tunnel host using username and ssh key",
                "type": "string",
                "enum": [
                  "SSH_KEY_AUTH"
                ],
                "default": "SSH_KEY_AUTH",
                "order": 0
              },
              "tunnel_host": {
                "title": "SSH Tunnel Jump Server Host",
                "description": "Hostname of the jump server host that allows inbound ssh tunnel.",
                "type": "string",
                "order": 1
              },
              "tunnel_ssh_port": {
                "title": "SSH Connection Port",
                "description": "Port on the proxy/jump server that accepts inbound ssh connections.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "default": 22,
                "examples": [
                  "22"
                ],
                "order": 2
              },
              "tunnel_username": {
                "title": "SSH Login Username",
                "description": "OS-level username for logging into the jump server host.",
                "type": "string",
                "order": 3
              },
              "tunnel_usersshkey": {
                "title": "SSH Private Key",
                "description": "OS-level user account ssh key credentials for logging into the jump server host.",
                "type": "string",
                "airbyte_secret": true,
                "multiline": true,
                "order": 4
              },
              "tunnel_db_remote_host": {
                "title": "Remote Database Host",
                "description": "Hostname or static IP address of the database to port-forward, as recognized from the jump server.",
                "type": "string",
                "order": 5
              },
              "tunnel_db_remote_port": {
                "title": "Remote Database Port",
                "description": "Port on the database to port-forward, typically that database's usual default port.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "examples": [
                  "5432"
                ],
                "order": 6
              },
              "tunnel_localport": {
                "title": "SSH Tunnel Database Port",
                "description": "Port on the jump server host for the database's port to forward to. Do not share a port between database instances.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "examples": [
                  "5000"
                ],
                "order": 7
              }
            }
          },
          {
            "title": "Password Authentication",
            "required": [
              "tunnel_method",
              "tunnel_host",
              "tunnel_ssh_port",
              "tunnel_username",
              "tunnel_localport",
              "tunnel_userpass"
            ],
            "properties": {
              "tunnel_method": {
                "description": "Connect through a jump server tunnel host using username and password authentication",
                "type": "string",
                "enum": [
                  "SSH_PASSWORD_AUTH"
                ],
                "default": "SSH_PASSWORD_AUTH",
                "order": 0
              },
              "tunnel_host": {
                "title": "SSH Tunnel Jump Server Host",
                "description": "Hostname of the jump server host that allows inbound ssh tunnel.",
                "type": "string",
                "order": 1
              },
              "tunnel_ssh_port": {
                "title": "SSH Connection Port",
                "description": "Port on the proxy/jump server that accepts inbound ssh connections.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "default": 22,
                "examples": [
                  "22"
                ],
                "order": 2
              },
              "tunnel_username": {
                "title": "SSH Login Username",
                "description": "OS-level username for logging into the jump server host",
                "type": "string",
                "order": 3
              },
              "tunnel_userpass": {
                "title": "Password",
                "description": "OS-level password for logging into the jump server host",
                "type": "string",
                "airbyte_secret": true,
                "order": 4
              },
              "tunnel_db_remote_host": {
                "title": "Remote Database Host",
                "description": "Hostname or static IP address of the database to port-forward, as recognized from the jump server.",
                "type": "string",
                "order": 5
              },
              "tunnel_db_remote_port": {
                "title": "Remote Database Port",
                "description": "Port on the database to port-forward, typically that database's usual default port.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "examples": [
                  "5432"
                ],
                "order": 6
              },
              "tunnel_localport": {
                "title": "SSH Tunnel Database Port",
                "description": "Port on the jump server host for the database's port to forward to. Do not share a port between database instances.",
                "type": "integer",
                "minimum": 0,
                "maximum": 65536,
                "examples": [
                  "5000"
                ],
                "order": 7
              }
            }
          }
        ]
      },
      "database": {
        "title": "DB Name",
        "description": "Name of the database.",
        "type": "string",
        "order": 7
      },
      "username": {
        "title": "User",
        "description": "Username to use to access the database.",
        "type": "string",
        "order": 8
      },
      "password": {
        "title": "Password",
        "description": "Password associated with the username.",
        "type": "string",
        "airbyte_secret": true,
        "order": 9
      },
      "ssl": {
        "title": "Connect using SSL",
        "description": "Encrypt client/server communications for increased security.",
        "type": "boolean",
        "default": false,
        "order": 10
      },
      "replication_method": {
        "type": "object",
        "title": "Replication Method",
        "description": "Replication method to use for extracting data from the database.",
        "order": 11,
        "oneOf": [
          {
            "title": "Standard",
            "additionalProperties": false,
            "description": "Standard replication requires no setup on the DB side but will not be able to represent deletions incrementally.",
            "required": [
              "method"
            ],
            "properties": {
              "method": {
                "type": "string",
                "const": "Standard",
                "enum": ["Standard"],
                "default": "Standard",
                "order": 0
              }
            }
          },
          {
            "title": "Logical Replication (CDC)",
            "additionalProperties": false,
            "description": "Logical replication uses the Postgres write-ahead log (WAL) to detect inserts, updates, and deletes. This needs to be configured on the source database itself. Only available on Postgres 10 and above. Read the <a href=\"https://docs.airbyte.io/integrations/sources/postgres\">Postgres Source</a> docs for more information.",
            "required": [
              "method",
              "replication_slot",
              "publication"
            ],
            "properties": {
              "method": {
                "type": "string",
                "const": "CDC",
                "enum": ["CDC"],
                "default": "CDC",
                "order": 0
              },
              "replication_slot": {
                "type": "string",
                "description": "A pgoutput logical replication slot.",
                "order": 1
              },
              "publication": {
                "type": "string",
                "description": "A Postgres publication used for consuming changes.",
                "order": 2
              }
            }
          }
        ]
      }
    }
  }
}
