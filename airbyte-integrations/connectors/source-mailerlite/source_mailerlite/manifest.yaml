version: "0.29.0"

definitions:
  selector:
    extractor:
      field_path: ["data"]

  requester:
    url_base: "https://connect.mailerlite.com/api"
    http_method: "GET"
    authenticator:
      type: BearerAuthenticator
      api_token: "{{ config['api_token'] }}"

  increment_paginator:
    type: "DefaultPaginator"
    page_size_option:
      inject_into: "request_parameter"
      field_name: "limit"
    pagination_strategy:
      type: "PageIncrement"
      page_size: 25
    page_token_option:
      type: RequestOption
      inject_into: "request_parameter"
      field_name: "page"

  retriever:
    record_selector:
      $ref: "#/definitions/selector"
    paginator:
      type: NoPagination
    requester:
      $ref: "#/definitions/requester"

  base_stream:
    retriever:
      $ref: "#/definitions/retriever"

  # STREAMS
  # API Docs: https://developers.mailerlite.com/docs/subscribers.html
  subscribers_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "subscribers"
      primary_key: "id"
      path: "/subscribers"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"

    # API Docs: https://developers.mailerlite.com/docs/segments.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          email:
            type: string
          status:
            type: string
          source:
            type: string
          sent:
            type: integer
          opens_count:
            type: integer
          clicks_count:
            type: integer
          open_rate:
            type: integer
          click_rate:
            type: integer
          ip_address:
            type:
              - string
              - "null"
          subscribed_at:
            type: string
          unsubscribed_at:
            type:
              - string
              - "null"
          created_at:
            type: string
          updated_at:
            type: string
          fields:
            type: object
            properties:
              name:
                type: string
              last_name:
                type:
                  - string
                  - "null"
              company:
                type:
                  - string
                  - "null"
              country:
                type:
                  - string
                  - "null"
              city:
                type:
                  - string
                  - "null"
              phone:
                type:
                  - string
                  - "null"
              state:
                type:
                  - string
                  - "null"
              z_i_p:
                type:
                  - string
                  - "null"
            required:
              - name
              - last_name
              - company
              - country
              - city
              - phone
              - state
              - z_i_p
          opted_in_at:
            type:
              - string
              - "null"
          optin_ip:
            type:
              - string
              - "null"
        required:
          - id
          - email
          - status
          - source
          - sent
          - opens_count
          - clicks_count
          - open_rate
          - click_rate
          - ip_address
          - subscribed_at
          - unsubscribed_at
          - created_at
          - updated_at
          - fields
          - opted_in_at
          - optin_ip
  segments_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "segments"
      primary_key: "id"
      path: "/segments"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"
        pagination_strategy:
          type: "PageIncrement"
          page_size: 50

    # API Docs: https://developers.mailerlite.com/docs/automations.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
          total:
            type: integer
          open_rate:
            type: object
            properties:
              float:
                type: number
              string:
                type: string
            required:
              - float
              - string
          click_rate:
            type: object
            properties:
              float:
                type: number
              string:
                type: string
            required:
              - float
              - string
          created_at:
            type: string
        required:
          - id
          - name
          - total
          - open_rate
          - click_rate
          - created_at
  automations_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "automations"
      primary_key: "id"
      path: "/automations"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"
        pagination_strategy:
          type: "PageIncrement"
          page_size: 10

    # API Docs: https://developers.mailerlite.com/docs/campaigns.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
          enabled:
            type: boolean
          trigger_data:
            type: object
            properties:
              track_ecommerce:
                type: boolean
              repeatable:
                type: boolean
              group_id:
                type: integer
              exclude_group_ids:
                type: array
                items:
                  type: integer
              valid:
                type: boolean
            required:
              - valid
          steps:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                type:
                  type: string
                parent_id:
                  type: string
                name:
                  type: string
                subject:
                  type: string
                from:
                  type: string
                from_name:
                  type: string
                email_id:
                  type: string
                email:
                  type: object
                  properties:
                    id:
                      type: string
                    account_id:
                      type: string
                    emailable_id:
                      type: string
                    emailable_type:
                      type: string
                    type:
                      type: string
                    from:
                      type: string
                    from_name:
                      type: string
                    name:
                      type: string
                    subject:
                      type: string
                    plain_text:
                      type:
                        - string
                        - "null"
                    screenshot_url:
                      type:
                        - string
                        - "null"
                    preview_url:
                      type:
                        - string
                        - "null"
                    created_at:
                      type: string
                    updated_at:
                      type: string
                    is_designed:
                      type: boolean
                    language_id:
                      type: integer
                    is_winner:
                      type: boolean
                    stats:
                      type: object
                      properties:
                        sent:
                          type: integer
                        opens_count:
                          type: integer
                        unique_opens_count:
                          type: integer
                        open_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        clicks_count:
                          type: integer
                        unique_clicks_count:
                          type: integer
                        click_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        unsubscribes_count:
                          type: integer
                        unsubscribe_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        spam_count:
                          type: integer
                        spam_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        hard_bounces_count:
                          type: integer
                        hard_bounce_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        soft_bounces_count:
                          type: integer
                        soft_bounce_rate:
                          type: object
                          properties:
                            float:
                              type: number
                            string:
                              type: string
                          required:
                            - float
                            - string
                        forwards_count:
                          type: integer
                      required:
                        - sent
                        - opens_count
                        - unique_opens_count
                        - open_rate
                        - clicks_count
                        - unique_clicks_count
                        - click_rate
                        - unsubscribes_count
                        - unsubscribe_rate
                        - spam_count
                        - spam_rate
                        - hard_bounces_count
                        - hard_bounce_rate
                        - soft_bounces_count
                        - soft_bounce_rate
                        - forwards_count
                    send_after:
                      type:
                        - string
                        - "null"
                    track_opens:
                      type: boolean
                  required:
                    - id
                    - account_id
                    - emailable_id
                    - emailable_type
                    - type
                    - from
                    - from_name
                    - name
                    - subject
                    - plain_text
                    - screenshot_url
                    - preview_url
                    - created_at
                    - updated_at
                    - is_designed
                    - language_id
                    - is_winner
                    - stats
                    - send_after
                    - track_opens
                language_id:
                  type: integer
                complete:
                  type: boolean
                created_at:
                  type: string
                updated_at:
                  type: string
                track_opens:
                  type: boolean
                google_analytics:
                  type:
                    - string
                    - "null"
                tracking_was_disabled:
                  type: boolean
                description:
                  type: string
              required:
                - id
          triggers:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                type:
                  type: string
                group_id:
                  type: string
                group:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: string
                    url:
                      type:
                        - string
                        - "null"
                  required:
                    - id
                    - name
                    - url
                exclude_group_ids:
                  type: array
                  items:
                    type: string
                excluded_groups:
                  type: array
                  items:
                    type: string
                broken:
                  type: boolean
              required:
                - id
                - type
                - group_id
                - group
                - exclude_group_ids
                - excluded_groups
                - broken
          complete:
            type: boolean
          broken:
            type: boolean
          warnings:
            type: array
            items:
              type: string
          emails_count:
            type: integer
          first_email_screenshot_url:
            type:
              - string
              - "null"
          stats:
            type: object
            properties:
              completed_subscribers_count:
                type: integer
              subscribers_in_queue_count:
                type: integer
              bounce_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              click_to_open_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              sent:
                type: integer
              opens_count:
                type: integer
              unique_opens_count:
                type:
                  - integer
                  - "null"
              open_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              clicks_count:
                type: integer
              unique_clicks_count:
                type:
                  - integer
                  - "null"
              click_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              unsubscribes_count:
                type: integer
              unsubscribe_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              spam_count:
                type: integer
              spam_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              hard_bounces_count:
                type: integer
              hard_bounce_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              soft_bounces_count:
                type: integer
              soft_bounce_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
            required:
              - completed_subscribers_count
              - subscribers_in_queue_count
              - bounce_rate
              - click_to_open_rate
              - sent
              - opens_count
              - unique_opens_count
              - open_rate
              - clicks_count
              - unique_clicks_count
              - click_rate
              - unsubscribes_count
              - unsubscribe_rate
              - spam_count
              - spam_rate
              - hard_bounces_count
              - hard_bounce_rate
              - soft_bounces_count
              - soft_bounce_rate
          created_at:
            type: string
          has_banned_content:
            type: boolean
          qualified_subscribers_count:
            type: integer
        required:
          - id
          - name
          - enabled
          - trigger_data
          - steps
          - triggers
          - complete
          - broken
          - warnings
          - emails_count
          - first_email_screenshot_url
          - stats
          - created_at
          - has_banned_content
          - qualified_subscribers_count
  campaigns_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "campaigns"
      primary_key: "id"
      path: "/campaigns"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"

    # API Docs: https://developers.mailerlite.com/docs/timezones.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
            format: integer
          account_id:
            type: string
            format: integer
          name:
            type: string
          type:
            type: string
          status:
            type: string
          missing_data:
            type: array
            items:
              type: string
          settings:
            type: object
            properties:
              track_opens:
                type: string
                format: integer
              use_google_analytics:
                type: string
                format: integer
              ecommerce_tracking:
                type: string
                format: integer
            required:
              - ecommerce_tracking
              - track_opens
              - use_google_analytics
          filter:
            type: array
            items:
              type: array
              items:
                type: object
                properties:
                  operator:
                    type: string
                  args:
                    type: array
                    items:
                      anyOf:
                        - type: array
                          items:
                            type: string
                            format: integer
                        - type: string
                required:
                  - args
                  - operator
          filter_for_humans:
            type: array
            items:
              type: array
              items:
                type: string
          delivery_schedule:
            type: string
          language_id:
            type: string
            format: integer
          created_at:
            type: string
            format: date-time
          updated_at:
            type: string
            format: date-time
          scheduled_for:
            type: string
            format: date-time
          queued_at:
            type:
              - string
              - "null"
            format: date-time
          started_at:
            type:
              - string
              - "null"
            format: date-time
          finished_at:
            type:
              - string
              - "null"
            format: date-time
          stopped_at:
            type:
              - string
              - "null"
          default_email_id:
            type: string
          emails:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                  format: integer
                account_id:
                  type: string
                  format: integer
                emailable_id:
                  type: string
                  format: integer
                emailable_type:
                  type: string
                type:
                  type: string
                from:
                  type: string
                from_name:
                  type: string
                name:
                  type:
                    - string
                    - "null"
                subject:
                  type: string
                plain_text:
                  type: string
                screenshot_url:
                  type:
                    - string
                    - "null"
                preview_url:
                  type:
                    - string
                    - "null"
                created_at:
                  type: string
                  format: date-time
                updated_at:
                  type: string
                  format: date-time
                is_designed:
                  type: boolean
                language_id:
                  type:
                    - integer
                    - "null"
                is_winner:
                  type: boolean
                stats:
                  type: object
                  properties:
                    sent:
                      type: integer
                    opens_count:
                      type: integer
                    unique_opens_count:
                      type: integer
                    open_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    clicks_count:
                      type: integer
                    unique_clicks_count:
                      type: integer
                    click_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    unsubscribes_count:
                      type: integer
                    unsubscribe_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    spam_count:
                      type: integer
                    spam_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    hard_bounces_count:
                      type: integer
                    hard_bounce_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    soft_bounces_count:
                      type: integer
                    soft_bounce_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                    forwards_count:
                      type: integer
                    click_to_open_rate:
                      type: object
                      properties:
                        float:
                          type: number
                        string:
                          type: string
                      required:
                        - float
                        - string
                  required:
                    - click_rate
                    - clicks_count
                    - forwards_count
                    - hard_bounce_rate
                    - hard_bounces_count
                    - open_rate
                    - opens_count
                    - sent
                    - soft_bounce_rate
                    - soft_bounces_count
                    - spam_count
                    - spam_rate
                    - unique_clicks_count
                    - unique_opens_count
                    - unsubscribe_rate
                    - unsubscribes_count
                send_after:
                  type:
                    - string
                    - "null"
                track_opens:
                  type: boolean
              required:
                - account_id
                - created_at
                - emailable_id
                - emailable_type
                - from
                - from_name
                - id
                - is_designed
                - is_winner
                - language_id
                - name
                - plain_text
                - preview_url
                - screenshot_url
                - send_after
                - stats
                - subject
                - track_opens
                - type
                - updated_at
          used_in_automations:
            type: boolean
          type_for_humans:
            type: string
          stats:
            type: object
            properties:
              sent:
                type: integer
              opens_count:
                type: integer
              unique_opens_count:
                type: integer
              open_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              clicks_count:
                type: integer
              unique_clicks_count:
                type: integer
              click_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              unsubscribes_count:
                type: integer
              unsubscribe_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              spam_count:
                type: integer
              spam_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              hard_bounces_count:
                type: integer
              hard_bounce_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              soft_bounces_count:
                type: integer
              soft_bounce_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
              forwards_count:
                type: integer
              click_to_open_rate:
                type: object
                properties:
                  float:
                    type: number
                  string:
                    type: string
                required:
                  - float
                  - string
            required:
              - click_rate
              - clicks_count
              - forwards_count
              - hard_bounce_rate
              - hard_bounces_count
              - open_rate
              - opens_count
              - sent
              - soft_bounce_rate
              - soft_bounces_count
              - spam_count
              - spam_rate
              - unique_clicks_count
              - unique_opens_count
              - unsubscribe_rate
              - unsubscribes_count
          is_stopped:
            type: boolean
          has_winner:
            type:
              - string
              - "null"
          winner_version_for_human:
            type:
              - string
              - "null"
          winner_sending_time_for_humans:
            type:
              - string
              - "null"
          winner_selected_manually_at:
            type:
              - string
              - "null"
          uses_ecommerce:
            type: boolean
          uses_survey:
            type: boolean
          can_be_scheduled:
            type: boolean
          warnings:
            type: array
            items:
              type: string
          initial_created_at:
            type:
              - string
              - "null"
          is_currently_sending_out:
            type: boolean
        required:
          - account_id
          - can_be_scheduled
          - created_at
          - default_email_id
          - delivery_schedule
          - emails
          - filter
          - filter_for_humans
          - finished_at
          - has_winner
          - id
          - initial_created_at
          - is_currently_sending_out
          - is_stopped
          - language_id
          - missing_data
          - name
          - queued_at
          - scheduled_for
          - settings
          - started_at
          - status
          - stopped_at
          - type
          - type_for_humans
          - updated_at
          - used_in_automations
          - uses_ecommerce
          - uses_survey
          - warnings
          - winner_selected_manually_at
          - winner_sending_time_for_humans
          - winner_version_for_human
  timezones_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "timezones"
      primary_key: "id"
      path: "/timezones"

    # API Docs: https://developers.mailerlite.com/docs/forms.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
          name_for_humans:
            type: string
          offset_name:
            type: string
          offset:
            type: integer
        required:
          - id
          - name
          - name_for_humans
          - offset_name
          - offset
  forms_popup_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "forms_popup"
      primary_key: "id"
      path: "/forms/popup"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"

    # API Docs: https://developers.mailerlite.com/docs/forms.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          type:
            type: string
          slug:
            type: string
          name:
            type: string
          created_at:
            type: string
          conversions_count:
            type: integer
          opens_count:
            type: integer
          conversion_rate:
            type: object
            properties:
              float:
                type: number
              string:
                type: string
            required:
              - float
              - string
          settings:
            type: object
            properties:
              double_optin:
                type: boolean
              groot_id:
                type: integer
              form_type:
                type: string
              triggers:
                type: array
                items:
                  type: string
              timeout_seconds:
                type: integer
              scroll_percentage:
                type: integer
              frequency:
                type: integer
              frequency_unit:
                type: string
              visibility:
                type: string
              url_list:
                type: array
                items:
                  type: string
              url_list_strict:
                type:
                  - "null"
                  - string
              hide_on:
                type: array
                items:
                  type: string
              schedule:
                type: string
            required:
              - double_optin
              - groot_id
              - form_type
              - triggers
              - timeout_seconds
              - scroll_percentage
              - frequency
              - frequency_unit
              - visibility
              - url_list
              - url_list_strict
              - hide_on
              - schedule
          last_registration_at:
            type:
              - string
              - "null"
          active:
            type: boolean
          is_broken:
            type: boolean
          has_content:
            type: boolean
          can:
            type: object
            properties:
              update:
                type: boolean
            required:
              - update
          used_in_automations:
            type: boolean
          warnings:
            type: array
            items:
              type: string
          double_optin:
            type:
              - boolean
              - "null"
          screenshot_url:
            type:
              - string
              - "null"
          has_missing_groups:
            type: boolean
          groups:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                name:
                  type: string
                active_count:
                  type: integer
                sent_count:
                  type: integer
                opens_count:
                  type: integer
                open_rate:
                  type: object
                  properties:
                    float:
                      type: integer
                    string:
                      type: string
                  required:
                    - float
                    - string
                clicks_count:
                  type: integer
                click_rate:
                  type: object
                  properties:
                    float:
                      type: integer
                    string:
                      type: string
                  required:
                    - float
                    - string
                unsubscribed_count:
                  type: integer
                unconfirmed_count:
                  type: integer
                bounced_count:
                  type: integer
                junk_count:
                  type: integer
                created_at:
                  type: string
              required:
                - id
                - name
                - active_count
                - sent_count
                - opens_count
                - open_rate
                - clicks_count
                - click_rate
                - unsubscribed_count
                - unconfirmed_count
                - bounced_count
                - junk_count
                - created_at
        required:
          - id
          - type
          - slug
          - name
          - created_at
          - conversions_count
          - opens_count
          - conversion_rate
          - settings
          - last_registration_at
          - active
          - is_broken
          - has_content
          - can
          - used_in_automations
          - warnings
          - double_optin
          - screenshot_url
  forms_embedded_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "forms_embedded"
      primary_key: "id"
      path: "/forms/embedded"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"

    # API Docs: https://developers.mailerlite.com/docs/forms.html
    schema_loader:
      type: InlineSchemaLoader
      schema:
        type: object
        properties:
          id:
            type: string
          type:
            type: string
          slug:
            type: string
          name:
            type: string
          created_at:
            type: string
          conversions_count:
            type: integer
          opens_count:
            type: integer
          conversion_rate:
            type: object
            properties:
              float:
                type: integer
              string:
                type: string
            required:
              - float
              - string
          settings:
            type: object
            properties:
              double_optin:
                type: boolean
              groot_id:
                type: integer
            required:
              - double_optin
              - groot_id
          last_registration_at:
            type:
              - "null"
              - string
          active:
            type: boolean
          is_broken:
            type: boolean
          has_content:
            type: boolean
          can:
            type: object
            properties:
              update:
                type: boolean
            required:
              - update
          used_in_automations:
            type: boolean
          warnings:
            type: array
            items:
              type: string
          double_optin:
            type: boolean
          screenshot_url:
            type: string
          has_missing_groups:
            type: boolean
          groups:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                name:
                  type: string
                active_count:
                  type: integer
                sent_count:
                  type: integer
                opens_count:
                  type: integer
                open_rate:
                  type: object
                  properties:
                    float:
                      type: number
                    string:
                      type: string
                  required:
                    - float
                    - string
                clicks_count:
                  type: integer
                click_rate:
                  type: object
                  properties:
                    float:
                      type: number
                    string:
                      type: string
                  required:
                    - float
                    - string
                unsubscribed_count:
                  type: integer
                unconfirmed_count:
                  type: integer
                bounced_count:
                  type: integer
                junk_count:
                  type: integer
                created_at:
                  type: string
              required:
                - id
                - name
                - active_count
                - sent_count
                - opens_count
                - open_rate
                - clicks_count
                - click_rate
                - unsubscribed_count
                - unconfirmed_count
                - bounced_count
                - junk_count
                - created_at
        required:
          - id
          - type
          - slug
          - name
          - created_at
          - conversions_count
          - opens_count
          - conversion_rate
          - settings
          - last_registration_at
          - active
          - is_broken
          - has_content
          - can
          - used_in_automations
          - warnings
          - double_optin
          - screenshot_url
          - has_missing_groups
          - groups
  forms_promotion_stream:
    $ref: "#/definitions/base_stream"
    $parameters:
      name: "forms_promotion"
      primary_key: "id"
      path: "/forms/promotion"
    retriever:
      $ref: "#/definitions/retriever"
      paginator:
        $ref: "#/definitions/increment_paginator"

    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-04/schema#
        type: object
        properties:
          id:
            type: string
          type:
            type: string
          slug:
            type: string
          name:
            type: string
          created_at:
            type: string
          conversions_count:
            type: integer
          opens_count:
            type: integer
          conversion_rate:
            type: object
            properties:
              float:
                type: integer
              string:
                type: string
            required:
              - float
              - string
          settings:
            type: object
            properties:
              groot_id:
                type: integer
              form_type:
                type: string
              triggers:
                type: array
                items:
                  type: string
              timeout_seconds:
                type: integer
              scroll_percentage:
                type: integer
              frequency:
                type: integer
              frequency_unit:
                type: string
              visibility:
                type: string
              url_list:
                type: array
                items:
                  type: string
              url_list_strict:
                type:
                  - array
                  - "null"
                items:
                  type: string
              hide_on:
                type: array
                items:
                  type: string
              schedule:
                type: string
              schedule_from:
                type: string
              schedule_until:
                type: string
              schedule_timezone_id:
                type: string
            required:
              - groot_id
              - form_type
              - triggers
              - timeout_seconds
              - scroll_percentage
              - frequency
              - frequency_unit
              - visibility
              - url_list
              - url_list_strict
              - hide_on
              - schedule
              - schedule_from
              - schedule_until
              - schedule_timezone_id
          last_registration_at:
            type:
              - string
              - "null"
          active:
            type: boolean
          is_broken:
            type: boolean
          has_content:
            type: boolean
          can:
            type: object
            properties:
              update:
                type: boolean
            required:
              - update
          used_in_automations:
            type: boolean
          warnings:
            type: array
            items:
              type: string
          double_optin:
            type:
              - string
              - "null"
          screenshot_url:
            type: string
          has_missing_groups:
            type: boolean
          groups:
            type: array
            items:
              type: string
        required:
          - id
          - type
          - slug
          - name
          - created_at
          - conversions_count
          - opens_count
          - conversion_rate
          - settings
          - last_registration_at
          - active
          - is_broken
          - has_content
          - can
          - used_in_automations
          - warnings
          - double_optin
          - screenshot_url
          - has_missing_groups
          - groups
streams:
  - "#/definitions/subscribers_stream"
  - "#/definitions/segments_stream"
  - "#/definitions/automations_stream"
  - "#/definitions/campaigns_stream"
  - "#/definitions/timezones_stream"
  - "#/definitions/forms_popup_stream"
  - "#/definitions/forms_embedded_stream"
  - "#/definitions/forms_promotion_stream"

check:
  stream_names: ["timezones"]
