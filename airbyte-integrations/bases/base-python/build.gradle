project.ext.pyModule = 'airbyte_protocol'
apply from: rootProject.file('tools/gradle/commons/integrations/python.gradle')
apply from: rootProject.file('tools/gradle/commons/integrations/image.gradle')

task generateProtocolClassFiles(type: Exec) {
    environment 'ROOT_DIR', rootDir.absolutePath
    commandLine 'bin/generate-protocol-files.sh'

    inputs.files file(rootDir.relativePath(file('airbyte-protocol/models/src/main/resources/airbyte_protocol')))
    outputs.cacheIf { true }
    dependsOn ':airbyte-integrations:bases:base-python:code-generator:buildImage'
}

assemble.dependsOn generateProtocolClassFiles
buildImage.dependsOn ':airbyte-integrations:bases:base:buildImage'
