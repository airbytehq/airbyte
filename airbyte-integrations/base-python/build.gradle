apply from: rootProject.file('tools/gradle/commons/integrations/image.gradle')

task deleteProtocolDefinitions(type: Delete) {
    delete 'airbyte_protocol/airbyte_protocol/types'
}

task copyProtocolDefinitions(type: Copy) {
    from file("$rootDir/airbyte-protocol/models/src/main/resources/airbyte_protocol").absolutePath
    into "airbyte_protocol/airbyte_protocol/types"
    dependsOn deleteProtocolDefinitions
}

clean.dependsOn deleteProtocolDefinitions
buildImage.dependsOn copyProtocolDefinitions
buildImage.dependsOn ':airbyte-integrations:base:buildImage'
