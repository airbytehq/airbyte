apply from: rootProject.file('tools/gradle/commons/integrations/image.gradle')

def typesDir = 'airbyte_protocol/models/yaml'
task deleteProtocolDefinitions(type: Delete) {
    delete typesDir
}

task copyProtocolDefinitions(type: Copy) {
    from file("$rootDir/airbyte-protocol/models/src/main/resources/airbyte_protocol").absolutePath
    into typesDir
    dependsOn deleteProtocolDefinitions
}

clean.dependsOn deleteProtocolDefinitions
buildImage.dependsOn copyProtocolDefinitions
buildImage.dependsOn ':airbyte-integrations:base:buildImage'
