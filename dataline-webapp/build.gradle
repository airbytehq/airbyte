plugins {
    id "base"
    id "com.github.node-gradle.node" version "2.2.4"
}

npm_run_build {
    // make sure the build task is executed only when appropriate files change
    inputs.files fileTree('public')
    inputs.files fileTree('src')
    inputs.file 'package.json'
    inputs.file 'package-lock.json'

    outputs.dir 'build'
}
assemble.dependsOn npm_run_build

task test(type: NpmTask) {
    dependsOn assemble

    args = ['run', 'test', '--', '--watchAll=false']
    inputs.files fileTree('src')
    inputs.file 'package.json'
    inputs.file 'package-lock.json'
}

clean {
    delete "${projectDir}/node_modules/"
}
